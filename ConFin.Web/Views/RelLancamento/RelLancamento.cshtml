
@{ Layout = null; }

<div class="modal-content">
    <div class="section" style="text-align: center">
        <h1 style="color: gray; font-size: 20pt;" class="caption">Relatório de Lançamentos</h1>
        <div class="divider" style="margin-top: -5px;"></div>
    </div>
    <div class="row">
        <form id="formRelLancamentos" class= "col s12">
            <div class="row">
                <div class="input-field col s3"></div>
                <div class="input-field col s3">
                    <input id="txtDataRelatorio" type="text" class="validate month-year">
                    <label for="txtDataRelatorio" class="active">Mês/Ano</label>
                </div>
                <div class="input-field col s3">
                    <a onclick="gerarRelLancamento()" href="javascript:void()" class="btn waves-effect waves-light">Gerar
                        <i class="material-icons">file_download</i>
                    </a>
                </div>
            </div>
        </form>
    </div>
</div>

<script>

    var urlGerarRelLancamento = '@Url.Action("Gerar", "RelLancamento")';

    $("#formRelLancamentos").submit(function(e) {
        e.preventDefault();
        gerarRelLancamento();
        return false;
    });

    function gerarRelLancamento() {
        $('.toast').remove();

        if ($.toast({ condition: !$("#txtDataRelatorio").val(), message: "Favor preencher o campo Mês/Ano" }))
            return false;

        var mes = parseInt($("#txtDataRelatorio").val().split("/")[0]);
        var ano = parseInt($("#txtDataRelatorio").val().split("/")[1]);

        if ($.toast({ condition: mes < 1 || mes > 12, message: "Favor preencher Mês corretamente" }))
            return false;

        if ($.toast({ condition: isNaN(ano), message: "Favor preencher Ano" }))
            return false;

        if ($.toast({ condition: ano < 1900 || ano > 2099, message: "O Ano deve estar entre 1900 e 2099" }))
            return false;

        var data = $("#txtDataRelatorio").val().split("/");
        window.open(urlGerarRelLancamento + "?mes=" + data[0] + "&ano=" + data[1]);
    }

</script>
